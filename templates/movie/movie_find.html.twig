{% extends 'base.html.twig' %}

{% block css %} 

    {# Range Slider #}
    <link rel="stylesheet" href="{{asset('asset/css/rSlider.css')}}">

{% endblock %}

{% block title %}Clap te trouve un film{% endblock %}

{% block content %}

    <div class="container find-movie">
        <div class="row justify-content-center">
            <img src="asset/img/logoLR.png" alt="logo Clap" class="logo mb-4 mt-5">
        </div>

        <div class="row row-cols-sm-2 justify-content-center">
            <h1 class="m-5 mt-lg-5 mb-lg-5 text-center">Clap te trouve un film ! </h1>
        </div>

        <div class="row justify-content-center">
            <h2 class="choice m-5 mt-lg-5 mb-lg-5 text-center">Tu sais déjà un peu ce que tu veux ...</h2>
        </div>

        {# Form with criteria #}
        <form method="get" class="mt-4" id="visitor_criteria">
            <div class="row justify-content-center mb-5">
                <div class="col-11 col-lg-6">
                    <h2 class="mb-5 text-center">Genres</h2>
                    <div class="mt-4">
                        <div class="row row-cols-xl-4 justify-content-center">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="action" name="with_genres[]" value="28">
                                <label class="form-check-label" for="action">Action</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="animation" name="with_genres[]" value="16">
                                <label class="form-check-label" for="animation">Animation</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="adventure" name="with_genres[]" value="12">
                                <label class="form-check-label" for="adventure">Aventure</label>
                            </div>
                        </div>
                        <div class="row row-cols-xl-4 justify-content-center ">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="comedy" name="with_genres[]" value="35">
                                <label class="form-check-label" for="comedy">Comédie</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="drama" name="with_genres[]" value="18">
                                <label class="form-check-scary" for="drama">Drame</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="horror" name="with_genres[]" value="27">
                                <label class="form-check-label" for="horror">Horreur</label>
                            </div>
                        </div>
                        <div class="row row-cols-xl-4 justify-content-center ">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="family" name="with_genres[]" value="10751">
                                <label class="form-check-label" for="family">Famille</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="fantastic" name="with_genres[]" value="14">
                                <label class="form-check-label" for="fantastic">Fantastique</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="war" name="with_genres[]" value="10752">
                                <label class="form-check-label" for="war">Guerre</label>
                            </div>
                        </div>
                        <div class="row row-cols-xl-4 justify-content-center ">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="history" name="with_genres[]" value="36">
                                <label class="form-check-label" for="history">Historique</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="crime" name="with_genres[]" value="80">
                                <label class="form-check-label" for="crime">Policier</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="romance" name="with_genres[]" value="10749">
                                <label class="form-check-label" for="romance">Romance</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="scifi" name="with_genres[]" value="878">
                                <label class="form-check-label" for="scifi">Science fiction</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="thriller" name="with_genres[]" value="53">
                                <label class="form-check-label" for="thriller">Thriller</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row justify-content-center my-5 py-5">
                <div class="col-8 col-lg-6">
                    <h2 class="mb-5 text-center">Année de production</h2>
                    <div class="form-group mt-5">
                        <input type="text" id="slider1" class="slider1" name="release_date">
                    </div>
                </div>
            </div>


            <div class="row justify-content-center my-5 py-5">
                <div class="col-8 col-lg-6">
                    <h2 class="mb-5 text-center">Durée du film</h2>
                    <div class="form-group mt-5">
                        <input type="text" id="slider2" class="slider2" name="with_runtime">
                    </div>
                </div>
            </div>
            
            {# Carousel display all results #}
            <div id="multi-item-example" class="carousel slide carousel-multi-item" data-ride="carousel">
                <!--Slides-->
                <div class="carousel-inner" role="listbox">
                    {# {% set i = 0 %} #}
                    {% for movie_result_global in movie_results_global %}
                        {# {% set i = i + 1 %} {{ i == 1 ? 'active' : '' }}#}
                        <div class="carousel-item active">
                            <div class="col-6 justify-content-center" style="float:left">
                                <div class="card mb-1 bg-secondary" style="width: 28rem">
                                    <img class="card-img-top rounded" src="http://image.tmdb.org/t/p/w92/{{ movie_result_global.poster_path }}" alt="{{ movie_result_global.title}}">
                                    <div class="card-body">
                                        <h5 class="card-title"><a href="{{ path('movie_details',{ id: movie_result_global.id }) }}">{{ movie_result_global.title }}</a></h5>
                                        <p class="card-text">{{ movie_result_global.overview|slice(0, 25) }}...</p>
                                        <a class="btn btn-outline-light btn-sm rounded" href="{{ path('movie_details',{ id: movie_result_global.id }) }}">Lire la suite</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                 <a class="carousel-control-prev" href="#multi-item-example" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#multi-item-example" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

            <div class="row justify-content-center my-5 py-5">
                <button type="submit" class="btn btn-secondary go" id="go">GO</button>
            </div>
        </form>
            
        {# separator #}
        <div class="row justify-content-center">
            <div class="col-6 separator"></div>
        </div>

        {# random recommendation #}
        <div class="row justify-content-center">
            <h2 class="choice mt-5 mb-5 text-center">Tu es aventureux ?</h2>
        </div>

        <div class="row justify-content-center mb-5 pb-5">
            <button type="submit" class="btn btn-secondary random-film" id="hasard">film au hasard</button>
        </div>

{% endblock %}

{% block js %}

    {# Range slider #}
    <script src="{{asset('asset/js/rSlider.min.js')}}"></script>

    {# Ajax - Axios #}
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>

        {# Ajax Random Function #}
        $('#hasard').on('click', function(){
            axios.get("{{ path('movie_ajax_random') }}")
            .then(function (response) {
                $('#title').html(response.data['title'])
                $('#poster').attr('src', 'http://image.tmdb.org/t/p/w500/' + response.data['poster_path'])
            })
            .catch(function (error) {
                console.log(error);
            });
        });

        {# Range slider Function #}
        (function () {
                var init = function () { 
                
                    var slider1 = new rSlider({
                        target: '#slider1',
                        values: {min: 1915, max: 2020},
                        range: true, // range slider
                        set: [1970, 2005],
                        scale:    true,
                        labels:   false,
                        step:     10, // step size
                        onChange: function (vals) {
                                    console.log(vals);
                                }
                    });
                    var slider2 = new rSlider({
                        target: '#slider2',
                        values: {min: 70, max: 210},
                        step: 10,
                        range: true,
                        set: [90, 120],
                        scale: true,
                        labels: false,
                        onChange: function (vals) {
                            console.log(vals);
                        }
                    });
                };
                window.onload = init;
        })();

        {# jQuery Tags function #}
        $(function() {
            // Assign values to variables
            var $peopleList, $newItemForm;
            $peopleList = $('#people_list');
            $newItemForm = $('#newItemForm');
            
            // Listen to the event submit the form (always put preventDefault)
            $newItemForm.on('submit', function(e) {
                e.preventDefault();
                // Get the value of the imput with val()
                var text = $('#with_people').val();
                // Add the retrieved value in the end of the list
                $peopleList.append('<li title="Cliquer pour enlever">' + text + '</li>');
                $('#with_people').val('');
            });
        
            // Listen to the event click to remove items
            $peopleList.on('click', 'li', function() {
                var $this = $(this);
                $this.remove();
            });
    
        });


    </script>

{% endblock %}